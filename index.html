<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ™ÿØÿ±Ÿäÿ® ÿßŸÑÿ∞ŸÉŸä - ŸÖÿ≠ŸÉŸÖÿ© ÿßŸÑŸÖÿ≠ÿßÿ≥ÿ®ÿßÿ™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .chatbot-toggler {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #1a472a 0%, #2ecc71 100%);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(46, 204, 113, 0.4);
            transition: all 0.3s ease;
            z-index: 9999;
        }

        .chatbot-toggler:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.6);
        }

        .chatbot-toggler span {
            color: white;
            font-size: 28px;
            position: absolute;
            transition: all 0.3s ease;
        }

        .chatbot-toggler .close-icon {
            opacity: 0;
            transform: rotate(-90deg);
        }

        body.show-chatbot .chatbot-toggler .chat-icon {
            opacity: 0;
            transform: rotate(90deg);
        }

        body.show-chatbot .chatbot-toggler .close-icon {
            opacity: 1;
            transform: rotate(0deg);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e74c3c;
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            animation: pulse-badge 2s infinite;
        }

        @keyframes pulse-badge {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .chatbot-container {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 420px;
            max-width: calc(100vw - 60px);
            height: 550px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            transform: scale(0) translateY(20px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 9998;
            display: flex;
            flex-direction: column;
        }

        body.show-chatbot .chatbot-container {
            transform: scale(1) translateY(0);
            opacity: 1;
        }

        .chat-header {
            background: linear-gradient(135deg, #1a472a 0%, #2ecc71 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .chat-header-info {
            flex: 1;
        }

        .chat-header h2 {
            font-size: 16px;
            margin-bottom: 3px;
        }

        .chat-header .status {
            font-size: 11px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #27ae60;
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .header-controls {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .icon-btn {
            width: 32px;
            height: 32px;
            border: 1px solid white;
            background: transparent;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .icon-btn.active {
            background: white;
            color: #1a472a;
        }

        .language-selector {
            display: flex;
            gap: 3px;
        }

        .lang-btn {
            padding: 4px 8px;
            border: 1px solid white;
            background: transparent;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 9px;
            transition: all 0.3s;
        }

        .lang-btn.active {
            background: white;
            color: #1a472a;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 10px;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .message.bot .message-avatar {
            background: linear-gradient(135deg, #2ecc71, #1a472a);
            color: white;
        }

        .message.user .message-avatar {
            background: #ecf0f1;
        }

        .message-content {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: 15px;
            word-wrap: break-word;
            font-size: 14px;
            line-height: 1.5;
            margin: 0 10px;
        }

        .message.bot .message-content {
            background: white;
            color: #333;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-bottom-left-radius: 5px;
        }

        .message.user .message-content {
            background: #2ecc71;
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message-time {
            font-size: 10px;
            opacity: 0.7;
            margin-top: 5px;
            display: block;
        }

        .typing-indicator {
            display: none;
            padding: 12px 16px;
            background: white;
            border-radius: 15px;
            width: fit-content;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-left: 42px;
        }

        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #2ecc71;
            border-radius: 50%;
            margin: 0 2px;
            animation: typing 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .chat-input-area {
            padding: 15px 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
            flex-shrink: 0;
        }

        .input-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        #userInput {
            flex: 1;
            padding: 10px 14px;
            border: 2px solid #e0e0e0;
            border-radius: 20px;
            font-size: 13px;
            outline: none;
            transition: border 0.3s;
            font-family: inherit;
        }

        #userInput:focus {
            border-color: #2ecc71;
        }

        .btn-send, .btn-voice, .btn-add {
            width: 38px;
            height: 38px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 16px;
        }

        .btn-send {
            background: #2ecc71;
            color: white;
        }

        .btn-send:hover {
            background: #27ae60;
            transform: scale(1.1);
        }

        .btn-voice {
            background: #3498db;
            color: white;
        }

        .btn-voice:hover {
            background: #2980b9;
        }

        .btn-voice.recording {
            background: #e74c3c;
            animation: pulse-recording 1s infinite;
        }

        .btn-add {
            background: #9b59b6;
            color: white;
        }

        .btn-add:hover {
            background: #8e44ad;
            transform: scale(1.1);
        }

        @keyframes pulse-recording {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        .course-link {
            display: inline-block;
            margin-top: 8px;
            padding: 6px 12px;
            background: #2ecc71;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 12px;
            transition: background 0.3s;
        }

        .course-link:hover {
            background: #27ae60;
        }

        .quick-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .suggestion-btn {
            padding: 6px 10px;
            background: #ecf0f1;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s;
            color: #2c3e50;
        }

        .suggestion-btn:hover {
            background: #2ecc71;
            color: white;
        }

        /* Modal ŸÑŸÑÿ•ÿ∂ÿßŸÅÿ© */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            color: #1a472a;
            font-size: 18px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: #e74c3c;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-size: 13px;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 13px;
            font-family: inherit;
            transition: border 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #2ecc71;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .btn-modal {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #2ecc71;
            color: white;
        }

        .btn-primary:hover {
            background: #27ae60;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .learned-badge {
            display: inline-block;
            background: #9b59b6;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            margin-right: 5px;
        }

        @media (max-width: 480px) {
            .chatbot-container {
                width: 100%;
                height: 100%;
                bottom: 0;
                right: 0;
                border-radius: 0;
            }

            .chatbot-toggler {
                bottom: 20px;
                right: 20px;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <button class="chatbot-toggler" id="chatbotToggler">
        <span class="chat-icon">üí¨</span>
        <span class="close-icon">‚úï</span>
        <span class="notification-badge" id="notificationBadge" style="display: none;">1</span>
    </button>

    <div class="chatbot-container">
        <div class="chat-header">
            <div class="chat-header-info">
                <h2 id="chatTitle">ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ™ÿØÿ±Ÿäÿ® ÿßŸÑÿ∞ŸÉŸä üß†</h2>
                <div class="status">
                    <span class="status-dot"></span>
                    <span id="statusText">ŸÖÿ™ÿµŸÑ ‚Ä¢ Ÿäÿ™ÿπŸÑŸÖ ŸÖŸÜ ÿ£ÿ≥ÿ¶ŸÑÿ™ŸÉ</span>
                </div>
            </div>
            <div class="header-controls">
                <button class="icon-btn" id="soundBtn" onclick="toggleSound()" title="ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿµŸàÿ™">üîá</button>
                <div class="language-selector">
                    <button class="lang-btn active" data-lang="ar" onclick="switchLanguage('ar')">AR</button>
                    <button class="lang-btn" data-lang="fr" onclick="switchLanguage('fr')">FR</button>
                    <button class="lang-btn" data-lang="en" onclick="switchLanguage('en')">EN</button>
                </div>
            </div>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="typing-indicator" id="typingIndicator">
                <span></span><span></span><span></span>
            </div>
        </div>

        <div class="chat-input-area">
            <div class="input-controls">
                <input type="text" id="userInput" placeholder="ÿßÿ∑ÿ±ÿ≠ ÿ≥ÿ§ÿßŸÑŸÉ..." />
                <button class="btn-add" onclick="openAddKnowledgeModal()" title="ÿ£ÿ∂ŸÅ ŸÖÿπŸÑŸàŸÖÿ© ÿ¨ÿØŸäÿØÿ©">‚ûï</button>
                <button class="btn-voice" id="voiceBtn" onclick="toggleVoiceRecognition()" title="ŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ">üé§</button>
                <button class="btn-send" onclick="sendMessage()" title="ÿ•ÿ±ÿ≥ÿßŸÑ">üì§</button>
            </div>
        </div>
    </div>

    <!-- Modal ŸÑÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ¨ÿØŸäÿØÿ© -->
    <div class="modal" id="addKnowledgeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ûï ÿ£ÿ∂ŸÅ ŸÖÿπŸÑŸàŸÖÿ© ÿ¨ÿØŸäÿØÿ©</h3>
                <button class="modal-close" onclick="closeAddKnowledgeModal()">√ó</button>
            </div>
            <form onsubmit="saveNewKnowledge(event)">
                <div class="form-group">
                    <label for="newKeywords">ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖŸÅÿ™ÿßÿ≠Ÿäÿ© (ÿßŸÅÿµŸÑ ÿ®ŸÅÿßÿµŸÑÿ©)</label>
                    <input type="text" id="newKeywords" placeholder="ŸÖÿ´ÿßŸÑ: ÿ™ŸÇŸäŸäŸÖÿå ŸÇŸäÿßÿ≥ÿå ÿßÿÆÿ™ÿ®ÿßÿ±" required>
                </div>
                <div class="form-group">
                    <label for="newResponse">ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ©/ÿßŸÑŸÖÿπŸÑŸàŸÖÿ©</label>
                    <textarea id="newResponse" placeholder="ÿßŸÉÿ™ÿ® ÿßŸÑŸÖÿπŸÑŸàŸÖÿ© ÿßŸÑÿ™Ÿä ÿ™ÿ±ŸäÿØ ÿ•ÿ∂ÿßŸÅÿ™Ÿáÿß..." required></textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="showLinkCheckbox" checked>
                        ÿπÿ±ÿ∂ ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿØÿ±ÿ≥ ŸÖÿπ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ©
                    </label>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-modal btn-secondary" onclick="closeAddKnowledgeModal()">ÿ•ŸÑÿ∫ÿßÿ°</button>
                    <button type="submit" class="btn-modal btn-primary">ÿ≠ŸÅÿ∏</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const COURSE_CONFIG = {
            courseUrl: 'http://association.courdescomptes.nat.tn:8080/course/view.php?id=43',
            courseName: 'ÿØŸàÿ±ÿ© ÿ™ÿØÿ±Ÿäÿ® ÿ£ÿÆÿµÿßÿ¶Ÿä ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä - ŸÖÿ≠ŸÉŸÖÿ© ÿßŸÑŸÖÿ≠ÿßÿ≥ÿ®ÿßÿ™'
        };

        const KNOWLEDGE_BASE = {
            ar: {
                suggestions: ['ŸÜŸÖŸàÿ∞ÿ¨ VARK', 'ŸÜÿ∏ÿ±Ÿäÿ© ŸÉŸàŸÑÿ®', 'ŸÖŸÜŸáÿ¨Ÿäÿ© ADDIE', 'ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™', 'ÿ£ŸáÿØÿßŸÅ ÿßŸÑÿ™ÿπŸÑŸÖ'],
                sections: [
                    {
                        keywords: ['ÿ™ÿπŸÑŸÖ ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä', 'elearning', 'ÿ™ÿπÿ±ŸäŸÅ', 'ŸÖŸÅŸáŸàŸÖ', 'ŸÖÿßŸáŸà'],
                        response: "üíª ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸáŸà ÿ™ŸÇÿØŸäŸÖ Ÿàÿ•ÿØÿßÿ±ÿ© ŸÅÿ±ÿµ ÿßŸÑÿ™ÿπŸÑŸÖ ŸàÿßŸÑÿØÿπŸÖ ÿπÿ®ÿ± ÿßŸÑŸÉŸÖÿ®ŸäŸàÿ™ÿ± ŸàÿßŸÑÿ¥ÿ®ŸÉÿßÿ™ ŸàÿßŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿπŸÑŸâ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™ÿå ŸàŸÖÿ§ÿÆÿ±Ÿãÿß ÿπŸÑŸâ ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑŸÖÿ™ŸÜŸÇŸÑ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÑŸàÿ≠Ÿäÿ© ŸàÿßŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ© ŸÑŸÑŸÖÿ≥ÿßÿπÿØÿ© ŸÅŸä ŸÖŸÖÿßÿ±ÿ≥ÿ© ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑŸÅÿ±ÿØŸä ŸàÿßŸÑÿ™ÿ∑Ÿàÿ±.",
                        showLink: true
                    },
                    {
                        keywords: ['ŸÖÿ≤ÿßŸäÿß', 'ŸÅŸàÿßÿ¶ÿØ', 'ŸÇŸäŸÖÿ©', 'ÿ£ŸáŸÖŸäÿ©'],
                        response: "‚ú® ŸÖÿ≤ÿßŸäÿß ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä: 1) ÿßŸÑÿ™ŸàÿßŸÅÿ± ŸÅŸä ÿ£Ÿä ŸàŸÇÿ™ ŸàŸÖŸÉÿßŸÜÿå 2) ÿßŸÑÿ™Ÿàÿ≠ŸäÿØ ŸàÿßŸÑÿ™ÿÆÿµŸäÿµÿå 3) ŸÅÿπÿßŸÑŸäÿ© ÿßŸÑÿ™ŸÉŸÑŸÅÿ©ÿå 4) ÿµÿØŸäŸÇ ŸÑŸÑÿ®Ÿäÿ¶ÿ©ÿå 5) ÿßŸÑÿ¥ŸÖŸàŸÑŸäÿ©ÿå 6) ÿßŸÑŸÖÿ±ŸàŸÜÿ© ŸÅŸä ÿßŸÑŸàŸÇÿ™ÿå 7) ÿßŸÑÿ™Ÿàÿ´ŸäŸÇ Ÿàÿ•ŸÖŸÉÿßŸÜŸäÿ© ÿßŸÑÿ±ÿ¨Ÿàÿπ ŸÑŸÑŸÖÿ≠ÿ™ŸàŸâÿå 8) ÿßŸÑŸàÿµŸàŸÑ ŸÑÿπÿØÿØ ŸÉÿ®Ÿäÿ± ŸÖŸÜ ÿßŸÑŸÖÿ¥ÿßÿ±ŸÉŸäŸÜ.",
                        showLink: false
                    },
                    {
                        keywords: ['lms', 'ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ™ÿπŸÑŸÖ', 'ŸÖŸÜÿµÿ©', 'moodle'],
                        response: "üñ•Ô∏è ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ™ÿπŸÑŸÖ (LMS) ŸáŸà ŸÖŸÜÿµÿ© ÿ™ŸÇŸÜŸäÿ© ŸÑÿßÿ≥ÿ™ÿ∂ÿßŸÅÿ© Ÿàÿ™ŸÜÿ∏ŸäŸÖ ÿßŸÑŸÖÿ≠ÿ™ŸàŸäÿßÿ™ÿå ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑÿßÿ™ ŸàÿßŸÑŸÖÿ≥ÿßÿ±ÿßÿ™ÿå ÿ™ÿ™ÿ®ÿπ ÿ™ŸÇÿØŸÖ ÿßŸÑŸÖÿ™ÿπŸÑŸÖŸäŸÜÿå ÿ™ÿ≥ŸáŸäŸÑ ÿßŸÑÿ™ŸÅÿßÿπŸÑÿßÿ™ÿå Ÿàÿ•ŸÜÿ¥ÿßÿ° ÿ™ŸÇÿßÿ±Ÿäÿ± ÿ™ÿ≠ŸÑŸäŸÑŸäÿ©. ŸÖÿ´ÿßŸÑ: Moodleÿå ŸàŸáŸà ŸÖŸÅÿ™Ÿàÿ≠ ÿßŸÑŸÖÿµÿØÿ± ŸàŸÖŸÜÿßÿ≥ÿ® ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿπŸÑŸäÿß ŸÑŸÑÿ±ŸÇÿßÿ®ÿ©.",
                        showLink: true
                    },
                    {
                        keywords: ['ŸÉŸàŸÑÿ®', 'ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿä', 'ÿØŸàÿ±ÿ© ÿßŸÑÿ™ÿπŸÑŸÖ', 'erga'],
                        response: "üìö ŸÜÿ∏ÿ±Ÿäÿ© ŸÉŸàŸÑÿ® ŸÑŸÑÿ™ÿπŸÑŸÖ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿä: ÿØŸàÿ±ÿ© ŸÖŸÜ 4 ŸÖÿ±ÿßÿ≠ŸÑ: 1) ÿßŸÑÿ™ÿ¨ÿ±ÿ®ÿ© ÿßŸÑŸÖŸÑŸÖŸàÿ≥ÿ©ÿå 2) ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿßŸÑÿ™ÿ£ŸÖŸÑŸäÿ©ÿå 3) ÿßŸÑÿ™ÿµŸàÿ± ÿßŸÑŸÖÿ¨ÿ±ÿØÿå 4) ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ® ÿßŸÑŸÜÿ¥ÿ∑. ŸÜŸÖŸàÿ∞ÿ¨ ERGA: ÿßŸÑÿ™ÿ¨ÿ±ÿ®ÿ© Experience ‚Üí ÿßŸÑÿ™ŸÅŸÉŸäÿ± Reflection ‚Üí ÿßŸÑÿ™ÿπŸÖŸäŸÖ Generalization ‚Üí ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ Application.",
                        showLink: true
                    },
                    {
                        keywords: ['ŸÅÿßÿ±ŸÉ', 'vark', 'ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ™ÿπŸÑŸÖ', 'ÿ®ÿµÿ±Ÿä', 'ÿ≥ŸÖÿπŸä', 'ÿ≠ÿ±ŸÉŸä'],
                        response: "üé® ŸÜŸÖŸàÿ∞ÿ¨ VARK: Visual ÿ®ÿµÿ±Ÿä (ÿµŸàÿ±ÿå ŸÅŸäÿØŸäŸà)ÿå Auditory ÿ≥ŸÖÿπŸä (ŸÖŸÜÿßŸÇÿ¥ÿßÿ™ÿå ÿ®ŸàÿØŸÉÿßÿ≥ÿ™)ÿå Reading/Writing ŸÇÿ±ÿßÿ¶Ÿä (ŸÜÿµŸàÿµÿå PDF)ÿå Kinesthetic ÿ≠ÿ±ŸÉŸä (ŸÖŸÖÿßÿ±ÿ≥ÿ©ÿå ŸÖÿ≠ÿßŸÉÿßÿ©). ŸÉŸÑ ŸÖÿ™ÿπŸÑŸÖ Ÿäÿ¨ŸÖÿπ ÿ®ŸäŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿ£ŸÜŸÖÿßÿ∑ ŸÖÿπ ÿ™ŸÅÿ∂ŸäŸÑ ŸÖŸáŸäŸÖŸÜ.",
                        showLink: true
                    },
                    {
                        keywords: ['ÿ£ŸÜÿØÿ±ÿßÿ∫Ÿàÿ¨Ÿäÿß', 'ÿ™ÿπŸÑŸäŸÖ ÿßŸÑŸÉÿ®ÿßÿ±', 'ŸÖÿ®ÿßÿØÿ¶'],
                        response: "üßë‚Äçüéì ŸÖÿ®ÿßÿØÿ¶ ÿ™ÿπŸÑŸÖ ÿßŸÑŸÉÿ®ÿßÿ±: 1) Ÿäÿ≠ÿ∂ÿ±ŸàŸÜ ÿÆÿ®ÿ±ÿßÿ™ ÿ≠Ÿäÿßÿ™Ÿäÿ© ÿ∫ŸÜŸäÿ©ÿå 2) Ÿäÿ™ÿπŸÑŸÖŸàŸÜ ÿ®ÿ™Ÿàÿ¨ŸäŸá ÿ∞ÿßÿ™Ÿäÿå 3) Ÿäÿ±ŸÉÿ≤ŸàŸÜ ÿπŸÑŸâ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÅŸàÿ±Ÿäÿå 4) ŸÑÿØŸäŸáŸÖ ÿØŸàÿßŸÅÿπ ÿ∞ÿßÿ™Ÿäÿ©ÿå 5) ÿπŸÖŸÑŸäŸàŸÜ ŸàŸäÿ≠ÿ®ŸàŸÜ ÿßŸÑÿ£ŸÖÿ´ŸÑÿ© ÿßŸÑŸàÿßŸÇÿπŸäÿ©ÿå 6) Ÿäÿ≠ÿ®ŸàŸÜ ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÖ Ÿàÿ™ŸÇÿØŸäÿ± ÿÆÿ®ÿ±ÿßÿ™ŸáŸÖ.",
                        showLink: true
                    },
                    {
                        keywords: ['addie', 'ÿ£ÿØŸä', 'ŸÖÿ±ÿßÿ≠ŸÑ', 'ŸÖŸÜŸáÿ¨Ÿäÿ©', 'ÿßŸÑÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸä'],
                        response: "üîß ŸÖŸÜŸáÿ¨Ÿäÿ© ADDIE: 1) ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ Analysis (ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ÿå ÿßŸÑŸÖÿ™ÿπŸÑŸÖŸäŸÜÿå ÿßŸÑŸÖŸáÿßŸÖ)ÿå 2) ÿßŸÑÿ™ÿµŸÖŸäŸÖ Design (ÿßŸÑÿ£ŸáÿØÿßŸÅÿå ŸáŸäŸÉŸÑ ÿßŸÑŸÖÿßÿØÿ©)ÿå 3) ÿßŸÑÿ•ÿπÿØÿßÿØ Development (ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ)ÿå 4) ÿßŸÑÿ™ŸÇÿØŸäŸÖ Implementation (ÿßŸÑÿ™ŸÜŸÅŸäÿ∞ÿå ÿßŸÑÿ™Ÿäÿ≥Ÿäÿ±)ÿå 5) ÿßŸÑÿ™ŸÇŸäŸäŸÖ Evaluation (ŸÇŸäÿßÿ≥ ÿßŸÑŸÅÿπÿßŸÑŸäÿ©).",
                        showLink: true
                    },
                    {
                        keywords: ['ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™', 'ÿßŸÑŸÅÿ¨Ÿàÿ©', 'ŸÅÿ¨Ÿàÿ© ÿßŸÑÿ£ÿØÿßÿ°'],
                        response: "üîç ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ Ÿäÿ≠ÿØÿØ ÿßŸÑŸÅÿ¨Ÿàÿßÿ™ ÿ®ŸäŸÜ ÿßŸÑŸÉŸÅÿßÿ°ÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ© ŸàÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©. ÿßŸÑÿ™ÿØÿ±Ÿäÿ® ŸÅŸÇÿ∑ ÿπŸÜÿØŸÖÿß ŸäŸÉŸàŸÜ ÿßŸÑÿ≥ÿ®ÿ® ŸÜŸÇÿµ ÿßŸÑŸÖÿπÿ±ŸÅÿ©/ÿßŸÑŸÖŸáÿßÿ±ÿßÿ™. ÿ£ŸÖÿß ÿßŸÑŸÖÿ¥ÿßŸÉŸÑ ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖŸäÿ© ŸÅÿ™ÿ≠ÿ™ÿßÿ¨ ÿ≠ŸÑŸàŸÑ ÿ•ÿØÿßÿ±Ÿäÿ© ŸÑÿß ÿ™ÿØÿ±Ÿäÿ®.",
                        showLink: true
                    },
                    {
                        keywords: ['ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸáÿßŸÖ', 'ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑÿ≠ÿ±ÿ¨ÿ©', 'ÿÆÿ∑Ÿàÿßÿ™ ÿßŸÑÿ£ÿØÿßÿ°'],
                        response: "üìã ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸáŸÖÿ© ŸäŸàÿ∂ÿ≠: 1) ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©ÿå 2) ÿßŸÑÿÆÿ∑Ÿàÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©ÿå 3) ÿßŸÑŸÖŸáÿßÿ±ÿßÿ™ ŸàÿßŸÑŸÖÿπÿ±ŸÅÿ© ÿßŸÑŸÑÿßÿ≤ŸÖÿ©ÿå 4) ÿ∏ÿ±ŸàŸÅ ÿßŸÑÿ£ÿØÿßÿ°ÿå 5) ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑŸÖŸÇÿ®ŸàŸÑ. ÿßŸÑŸÜÿßÿ™ÿ¨: ÿ£ŸáÿØÿßŸÅ ÿßŸÑÿ£ÿØÿßÿ° Performance Objectives.",
                        showLink: true
                    },
                    {
                        keywords: ['ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ™ÿπŸÑŸÖŸäŸÜ', 'ÿßŸÑÿ¨ŸÖŸáŸàÿ± ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ', 'ÿÆÿµÿßÿ¶ÿµ'],
                        response: "üë• ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖÿ™ÿπŸÑŸÖŸäŸÜ ŸäŸÅÿ≠ÿµ: 1) ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸä ŸàÿßŸÑÿÆÿ®ÿ±ÿ©ÿå 2) ÿßŸÑŸÇÿØÿ±ÿßÿ™ ÿßŸÑŸÖÿπÿ±ŸÅŸäÿ©ÿå 3) ÿßŸÑŸÑÿ∫ÿ© ŸàÿßŸÑÿ´ŸÇÿßŸÅÿ©ÿå 4) ÿßŸÑÿ¨ŸÜÿ≥ ŸàÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™ ÿßŸÑÿÆÿßÿµÿ©ÿå 5) ÿßŸÑÿØÿßŸÅÿπŸäÿ© ŸàŸÖŸáÿßÿ±ÿßÿ™ ÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ÿå 6) ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ©.",
                        showLink: true
                    },
                    {
                        keywords: ['ÿßŸÑÿ≥ÿ®ÿ® ÿßŸÑÿ¨ÿ∞ÿ±Ÿä', 'ÿÆŸÖÿ≥ ŸÑŸÖÿßÿ∞ÿß', 'ÿßŸÑÿ≥ŸÖŸÉÿ©', 'fishbone'],
                        response: "üêü ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ≥ÿ®ÿ® ÿßŸÑÿ¨ÿ∞ÿ±Ÿä: 1) ÿÆŸÖÿ≥ ŸÑŸÖÿßÿ∞ÿß (ÿßÿ≥ÿ£ŸÑ 'ŸÑŸÖÿßÿ∞ÿßÿü' 5 ŸÖÿ±ÿßÿ™)ÿå 2) ŸÖÿÆÿ∑ÿ∑ ÿπÿ∏ŸÖÿ© ÿßŸÑÿ≥ŸÖŸÉÿ© (ÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿ£ÿ≥ÿ®ÿßÿ®: ÿßŸÑÿ£ÿ¥ÿÆÿßÿµÿå ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ÿå ÿßŸÑÿ£ÿØŸàÿßÿ™ÿå ÿßŸÑÿ≥Ÿäÿßÿ≥ÿßÿ™ÿå ÿßŸÑÿ®Ÿäÿ¶ÿ©). ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ÿ®ŸäŸÜ ÿßŸÑÿ≥ÿ®ÿ® ÿßŸÑÿ¨ÿ∞ÿ±Ÿä ŸàÿßŸÑÿ£ÿπÿ±ÿßÿ∂.",
                        showLink: true
                    },
                    {
                        keywords: ['ÿ£ŸáÿØÿßŸÅ ÿßŸÑÿ™ÿπŸÑŸÖ', 'smart', 'ÿ£ŸáÿØÿßŸÅ ÿ£ÿØÿßÿ°'],
                        response: "üéØ ŸáÿØŸÅ ÿßŸÑÿ™ÿπŸÑŸÖ: 1) ÿßŸÑÿ∏ÿ±ŸàŸÅ (ÿßŸÑÿ£ÿØŸàÿßÿ™ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©)ÿå 2) ÿßŸÑÿ£ÿØÿßÿ° (ŸÅÿπŸÑ ŸÇÿßÿ®ŸÑ ŸÑŸÑŸÇŸäÿßÿ≥: ŸäÿµŸÅÿå Ÿäÿ≠ŸÑŸÑÿå ŸäÿµŸÖŸÖ)ÿå 3) ÿßŸÑŸÖÿπÿßŸäŸäÿ± (ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ£ÿØÿßÿ°: ÿ®ÿØŸÇÿ© 80%)ÿå 4) ÿßŸÑÿ™ŸÇŸäŸäŸÖ (ŸÖŸÜ ÿ≥Ÿäÿ≠ŸÉŸÖ: ÿßŸÑŸÖŸäÿ≥ÿ±ÿå ÿßŸÑÿ£ŸÇÿ±ÿßŸÜÿå ÿßŸÑÿ∞ÿßÿ™).",
                        showLink: true
                    },
                    {
                        keywords: ['ŸáŸäŸÉŸÑ ÿßŸÑŸÖÿßÿØÿ©', 'ÿßŸÑŸàÿ≠ÿØÿßÿ™', 'ÿ™ŸÇÿ≥ŸäŸÖ ÿßŸÑÿØŸàÿ±ÿ©'],
                        response: "üìö ÿ™ÿµŸÖŸäŸÖ ŸáŸäŸÉŸÑ ÿßŸÑŸÖÿßÿØÿ©: 1) ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸàÿ≠ÿØÿßÿ™ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©ÿå 2) ŸÉŸÑ Ÿàÿ≠ÿØÿ© ÿ™ÿ∫ÿ∑Ÿä 2-3 ŸÜŸÇÿßÿ∑ ÿ™ÿπŸÑŸÖ ÿ±ÿ¶Ÿäÿ≥Ÿäÿ©ÿå 3) ÿ™ÿ±ÿ™Ÿäÿ® ŸÖŸÜÿ∑ŸÇŸä ŸÖŸÜ ÿßŸÑÿ®ÿ≥Ÿäÿ∑ ŸÑŸÑŸÖÿπŸÇÿØÿå 4) ÿ™Ÿàÿßÿ≤ŸÜ ÿ®ŸäŸÜ ÿßŸÑŸàÿ≠ÿØÿßÿ™ÿå 5) ŸÉŸÑ Ÿàÿ≠ÿØÿ© ŸÑŸáÿß ŸáÿØŸÅ Ÿàÿßÿ∂ÿ≠.",
                        showLink: true
                    },
                    {
                        keywords: ['ÿ™ŸÇŸäŸäŸÖ', 'ŸÉŸäÿ±ŸÉÿ®ÿßÿ™ÿ±ŸäŸÉ', 'kirkpatrick', 'ŸÇŸäÿßÿ≥ ÿßŸÑÿ£ÿ´ÿ±'],
                        response: "üìä ŸÜŸÖŸàÿ∞ÿ¨ ŸÉŸäÿ±ŸÉÿ®ÿßÿ™ÿ±ŸäŸÉ: ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ 1: ÿ±ÿØ ÿßŸÑŸÅÿπŸÑ (ÿ±ÿ∂ÿß ÿßŸÑŸÖÿ¥ÿßÿ±ŸÉŸäŸÜ)ÿå ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ 2: ÿßŸÑÿ™ÿπŸÑŸÖ (ÿßŸÉÿ™ÿ≥ÿßÿ® ŸÖÿπÿßÿ±ŸÅ)ÿå ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ 3: ÿßŸÑÿ≥ŸÑŸàŸÉ (ÿ™ÿ∑ÿ®ŸäŸÇ ŸÅŸä ÿßŸÑÿπŸÖŸÑ)ÿå ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ 4: ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ (ÿßŸÑÿ£ÿ´ÿ± ÿπŸÑŸâ ÿßŸÑŸÖŸÜÿ∏ŸÖÿ©ÿå ROI).",
                        showLink: true
                    },
                    {
                        keywords: ['ŸÖÿ±ÿ≠ÿ®ÿß', 'ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖ', 'ÿ£ŸáŸÑÿß', 'hello'],
                        response: "üëã ŸÖÿ±ÿ≠ÿ®Ÿãÿß! ÿ£ŸÜÿß ŸÖÿ≥ÿßÿπÿØŸÉ ÿßŸÑÿ∞ŸÉŸä ÿßŸÑÿ∞Ÿä Ÿäÿ™ÿπŸÑŸÖ ŸÖŸÜ ÿ£ÿ≥ÿ¶ŸÑÿ™ŸÉ! ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä: ADDIEÿå VARKÿå ŸÉŸàŸÑÿ®ÿå ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ÿå ÿßŸÑÿ™ŸÇŸäŸäŸÖÿå Ÿàÿ£ŸÉÿ´ÿ±. ŸÉŸÖÿß ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ¨ÿØŸäÿØÿ© ÿ®ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿ≤ÿ± ‚ûï",
                        showLink: false
                    },
                    {
                        keywords: ['ÿ¥ŸÉÿ±ÿß', 'ÿ¥ŸÉÿ±ÿßŸã', 'thanks'],
                        response: "üòä ÿßŸÑÿπŸÅŸà! ÿ≥ÿπŸäÿØ ÿ®ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ. ŸÑÿß ÿ™ŸÜÿ≥Ÿé ÿ£ŸÜŸá ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ¨ÿØŸäÿØÿ© ŸÑÿ™ÿ∑ŸàŸäÿ± ŸÇÿßÿπÿØÿ© ŸÖÿπÿßÿ±ŸÅŸä! üéì",
                        showLink: false
                    }
                ]
            },
            fr: {
                suggestions: ['VARK', 'Kolb', 'ADDIE', 'Analyse', 'Objectifs'],
                sections: [
                    {
                        keywords: ['elearning', 'apprentissage', 'd√©finition'],
                        response: "üíª L'e-learning est la fourniture et gestion d'opportunit√©s d'apprentissage via ordinateur, r√©seaux et technologies Internet.",
                        showLink: true
                    },
                    {
                        keywords: ['bonjour', 'salut'],
                        response: "üëã Bonjour! Je suis votre assistant intelligent qui apprend de vos questions! Utilisez le bouton ‚ûï pour ajouter de nouvelles informations.",
                        showLink: false
                    }
                ]
            },
            en: {
                suggestions: ['VARK', 'Kolb', 'ADDIE', 'Analysis', 'Objectives'],
                sections: [
                    {
                        keywords: ['elearning', 'definition'],
                        response: "üíª E-learning is the delivery and management of learning opportunities via computer and Internet-based technology.",
                        showLink: true
                    },
                    {
                        keywords: ['hello', 'hi'],
                        response: "üëã Hello! I'm your smart assistant that learns from your questions! Use the ‚ûï button to add new information.",
                        showLink: false
                    }
                ]
            }
        };

        const TRANSLATIONS = {
            ar: {
                chatTitle: "ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ™ÿØÿ±Ÿäÿ® ÿßŸÑÿ∞ŸÉŸä üß†",
                statusText: "ŸÖÿ™ÿµŸÑ ‚Ä¢ Ÿäÿ™ÿπŸÑŸÖ ŸÖŸÜ ÿ£ÿ≥ÿ¶ŸÑÿ™ŸÉ",
                inputPlaceholder: "ÿßÿ∑ÿ±ÿ≠ ÿ≥ÿ§ÿßŸÑŸÉ...",
                welcomeMessage: "üëã ŸÖÿ±ÿ≠ÿ®Ÿãÿß! ÿ£ŸÜÿß ŸÖÿ≥ÿßÿπÿØŸÉ ÿßŸÑÿ∞ŸÉŸä ÿßŸÑÿ∞Ÿä Ÿäÿ™ÿπŸÑŸÖ ŸÖŸÜ ÿ£ÿ≥ÿ¶ŸÑÿ™ŸÉ Ÿàÿ•ÿ¨ÿßÿ®ÿßÿ™ŸÉ. ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿ≤ÿ± ‚ûï ŸÑÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ¨ÿØŸäÿØÿ©!",
                voiceLang: "ar-SA",
                linkText: "üîó ÿßŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑÿØÿ±ÿ≥",
                defaultResponse: "ü§î ŸÑŸÖ ÿ£ÿ¨ÿØ ŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÖÿ≠ÿØÿØÿ© ÿ≠ŸàŸÑ Ÿáÿ∞ÿß ÿßŸÑŸÖŸàÿ∂Ÿàÿπ. ŸáŸÑ ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿ®ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿ≤ÿ± ‚ûï ŸÑŸäÿ™ÿπŸÑŸÖ ÿßŸÑÿ¥ÿßÿ™ ÿ®Ÿàÿ™ÿü",
                knowledgeAdded: "‚úÖ ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿ© ÿ®ŸÜÿ¨ÿßÿ≠! ÿßŸÑÿ¢ŸÜ ŸäŸÖŸÉŸÜŸÜŸä ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑŸÖŸàÿ∂Ÿàÿπ.",
                learnedFrom: "ÿ™ÿπŸÑŸÖÿ™ ŸÖŸÜ"
            },
            fr: {
                chatTitle: "Assistant Intelligent üß†",
                statusText: "En ligne ‚Ä¢ Apprend de vos questions",
                inputPlaceholder: "Posez votre question...",
                welcomeMessage: "üëã Bonjour! Je suis votre assistant intelligent qui apprend! Utilisez ‚ûï pour ajouter des informations.",
                voiceLang: "fr-FR",
                linkText: "üîó Acc√©der au cours",
                defaultResponse: "ü§î Je n'ai pas trouv√© d'informations. Voulez-vous ajouter la r√©ponse avec ‚ûï?",
                knowledgeAdded: "‚úÖ Information ajout√©e!",
                learnedFrom: "Appris de"
            },
            en: {
                chatTitle: "Smart Assistant üß†",
                statusText: "Online ‚Ä¢ Learning from you",
                inputPlaceholder: "Ask your question...",
                welcomeMessage: "üëã Hello! I'm your smart assistant that learns! Use ‚ûï to add new information.",
                voiceLang: "en-US",
                linkText: "üîó Access course",
                defaultResponse: "ü§î I don't have information on this. Would you like to add it with ‚ûï?",
                knowledgeAdded: "‚úÖ Information added!",
                learnedFrom: "Learned from"
            }
        };

        let currentLanguage = 'ar';
        let isRecording = false;
        let isSoundEnabled = false;
        let recognition = null;
        let synthesis = window.speechSynthesis;
        let isChatOpen = false;

        // LocalStorage ŸÑŸÑÿ™ÿπŸÑŸÖ
        const STORAGE_KEY = 'chatbot_learned_knowledge';

        function getLearnedKnowledge() {
            const stored = localStorage.getItem(STORAGE_KEY);
            return stored ? JSON.parse(stored) : { ar: [], fr: [], en: [] };
        }

        function saveLearnedKnowledge(lang, entry) {
            const learned = getLearnedKnowledge();
            learned[lang].push({
                ...entry,
                timestamp: new Date().toISOString(),
                learnedBy: 'user'
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(learned));
            console.log('‚úÖ Knowledge saved:', entry);
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializeSpeechRecognition();
            loadLearnedKnowledge();
            setTimeout(() => {
                if (!isChatOpen) {
                    document.getElementById('notificationBadge').style.display = 'flex';
                }
            }, 3000);
        });

        function loadLearnedKnowledge() {
            const learned = getLearnedKnowledge();
            let totalLearned = 0;
            for (let lang in learned) {
                totalLearned += learned[lang].length;
            }
            console.log(`üìö Loaded ${totalLearned} learned entries`);
        }

        document.getElementById('chatbotToggler').addEventListener('click', function() {
            document.body.classList.toggle('show-chatbot');
            isChatOpen = !isChatOpen;

            if (isChatOpen) {
                document.getElementById('notificationBadge').style.display = 'none';
                if (document.getElementById('chatMessages').children.length === 1) {
                    setTimeout(() => {
                        displayWelcomeMessage();
                    }, 300);
                }
                document.getElementById('userInput').focus();
            }
        });

        function displayWelcomeMessage() {
            const learned = getLearnedKnowledge();
            const learnedCount = learned[currentLanguage].length;

            let message = TRANSLATIONS[currentLanguage].welcomeMessage;
            if (learnedCount > 0) {
                message += ` ŸÑÿØŸäŸë ÿßŸÑÿ¢ŸÜ ${learnedCount} ŸÖÿπŸÑŸàŸÖÿ© ÿ•ÿ∂ÿßŸÅŸäÿ© ÿ™ÿπŸÑŸÖÿ™Ÿáÿß ŸÖŸÜŸÉŸÖ! üéâ`;
            }

            displayMessage(message, 'bot');

            const suggestions = KNOWLEDGE_BASE[currentLanguage].suggestions;
            const suggestionsHTML = suggestions.map(s => 
                `<button class="suggestion-btn" onclick="handleSuggestion('${s}')">${s}</button>`
            ).join('');

            const suggestionDiv = document.createElement('div');
            suggestionDiv.className = 'message bot';
            suggestionDiv.innerHTML = `
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    <div>ÿßŸÇÿ™ÿ±ÿßÿ≠ÿßÿ™ ÿ≥ÿ±Ÿäÿπÿ©:</div>
                    <div class="quick-suggestions">${suggestionsHTML}</div>
                </div>
            `;

            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.insertBefore(suggestionDiv, document.getElementById('typingIndicator'));
        }

        function handleSuggestion(suggestion) {
            document.getElementById('userInput').value = suggestion;
            sendMessage();
        }

        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();

            if (message === '') return;

            displayMessage(message, 'user');
            input.value = '';

            showTypingIndicator();

            setTimeout(() => {
                const response = generateResponse(message);
                hideTypingIndicator();
                displayMessage(response.text, 'bot', response.showLink, response.isLearned);
                if (isSoundEnabled) {
                    speakResponse(response.text);
                }
            }, 800);
        }

        function generateResponse(question) {
            const lowerQuestion = question.toLowerCase();

            // ÿ£ŸàŸÑÿßŸã: ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖÿπÿ±ŸÅÿ© ÿßŸÑŸÖÿ™ÿπŸÑŸÖÿ©
            const learned = getLearnedKnowledge();
            for (let entry of learned[currentLanguage]) {
                for (let keyword of entry.keywords) {
                    if (lowerQuestion.includes(keyword.toLowerCase())) {
                        return {
                            text: entry.response,
                            showLink: entry.showLink,
                            isLearned: true
                        };
                    }
                }
            }

            // ÿ´ÿßŸÜŸäÿßŸã: ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑŸÖÿπÿßÿ±ŸÅ ÿßŸÑÿ£ÿµŸÑŸäÿ©
            const langData = KNOWLEDGE_BASE[currentLanguage];
            for (let section of langData.sections) {
                for (let keyword of section.keywords) {
                    if (lowerQuestion.includes(keyword)) {
                        return {
                            text: section.response,
                            showLink: section.showLink,
                            isLearned: false
                        };
                    }
                }
            }

            return {
                text: TRANSLATIONS[currentLanguage].defaultResponse,
                showLink: true,
                isLearned: false
            };
        }

        function displayMessage(message, sender, showLink = false, isLearned = false) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;

            const now = new Date();
            const time = now.getHours().toString().padStart(2, '0') + ':' + 
                        now.getMinutes().toString().padStart(2, '0');

            const avatar = sender === 'bot' ? 'ü§ñ' : 'üë§';

            let linkHTML = '';
            if (showLink && sender === 'bot') {
                linkHTML = `<br><a href="${COURSE_CONFIG.courseUrl}" target="_blank" class="course-link">${TRANSLATIONS[currentLanguage].linkText}</a>`;
            }

            let learnedBadge = '';
            if (isLearned && sender === 'bot') {
                learnedBadge = `<span class="learned-badge">‚ú® ${TRANSLATIONS[currentLanguage].learnedFrom}</span>`;
            }

            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    ${learnedBadge}${message}${linkHTML}
                    <span class="message-time">${time}</span>
                </div>
            `;

            messagesContainer.insertBefore(messageDiv, document.getElementById('typingIndicator'));
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'block';
            document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        // ============================================
        // MODAL ŸÑÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ¨ÿØŸäÿØÿ©
        // ============================================
        function openAddKnowledgeModal() {
            document.getElementById('addKnowledgeModal').classList.add('show');
            document.getElementById('newKeywords').focus();
        }

        function closeAddKnowledgeModal() {
            document.getElementById('addKnowledgeModal').classList.remove('show');
            document.getElementById('newKeywords').value = '';
            document.getElementById('newResponse').value = '';
            document.getElementById('showLinkCheckbox').checked = true;
        }

        function saveNewKnowledge(event) {
            event.preventDefault();

            const keywordsInput = document.getElementById('newKeywords').value;
            const response = document.getElementById('newResponse').value;
            const showLink = document.getElementById('showLinkCheckbox').checked;

            const keywords = keywordsInput.split(',').map(k => k.trim()).filter(k => k.length > 0);

            if (keywords.length === 0 || response.length === 0) {
                alert('ÿßŸÑÿ±ÿ¨ÿßÿ° ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ');
                return;
            }

            const newEntry = {
                keywords: keywords,
                response: response,
                showLink: showLink
            };

            saveLearnedKnowledge(currentLanguage, newEntry);

            closeAddKnowledgeModal();

            displayMessage(TRANSLATIONS[currentLanguage].knowledgeAdded, 'bot');

            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿØÿßÿØ
            const learned = getLearnedKnowledge();
            const count = learned[currentLanguage].length;
            document.getElementById('statusText').textContent = `ŸÖÿ™ÿµŸÑ ‚Ä¢ ${count} ŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÖÿ™ÿπŸÑŸÖÿ©`;
        }

        // ============================================
        // SPEECH RECOGNITION & SYNTHESIS
        // ============================================
        function initializeSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();

                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = TRANSLATIONS[currentLanguage].voiceLang;

                recognition.onstart = function() {
                    isRecording = true;
                    document.getElementById('voiceBtn').classList.add('recording');
                };

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('userInput').value = transcript;
                    sendMessage();
                };

                recognition.onend = function() {
                    isRecording = false;
                    document.getElementById('voiceBtn').classList.remove('recording');
                };
            } else {
                document.getElementById('voiceBtn').style.display = 'none';
            }
        }

        function toggleVoiceRecognition() {
            if (!recognition) return;

            if (isRecording) {
                recognition.stop();
            } else {
                recognition.lang = TRANSLATIONS[currentLanguage].voiceLang;
                recognition.start();
            }
        }

        function toggleSound() {
            isSoundEnabled = !isSoundEnabled;
            const soundBtn = document.getElementById('soundBtn');

            if (isSoundEnabled) {
                soundBtn.innerHTML = 'üîä';
                soundBtn.title = 'ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™';
                soundBtn.classList.add('active');
            } else {
                soundBtn.innerHTML = 'üîá';
                soundBtn.title = 'ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿµŸàÿ™';
                soundBtn.classList.remove('active');
                if (synthesis) synthesis.cancel();
            }
        }

        function speakResponse(text) {
            if (!synthesis || !isSoundEnabled) return;

            const cleanText = text.replace(/[\u{1F300}-\u{1F9FF}]/gu, '')
                                  .replace(/[0-9]/g, '')
                                  .replace(/[()]/g, '')
                                  .replace(/‚úÖ|ü§î|‚ûï|‚ú®/g, '')
                                  .trim();

            if (!cleanText) return;

            synthesis.cancel();

            const utterance = new SpeechSynthesisUtterance(cleanText);

            if (currentLanguage === 'ar') {
                utterance.lang = 'ar-SA';
                utterance.rate = 0.85;
                utterance.pitch = 1.0;
            } else if (currentLanguage === 'fr') {
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.pitch = 1.0;
            } else {
                utterance.lang = 'en-US';
                utterance.rate = 0.9;
                utterance.pitch = 1.0;
            }

            let voices = synthesis.getVoices();

            if (voices.length === 0) {
                synthesis.addEventListener('voiceschanged', () => {
                    voices = synthesis.getVoices();
                    setVoiceAndSpeak(utterance, voices);
                }, { once: true });
                return;
            }

            setVoiceAndSpeak(utterance, voices);
        }

        function setVoiceAndSpeak(utterance, voices) {
            let selectedVoice = null;

            if (currentLanguage === 'ar') {
                const arabicVoiceNames = ['Microsoft Hoda', 'Google Arabic', 'ar-SA', 'ar-EG', 'Arabic'];

                for (let voiceName of arabicVoiceNames) {
                    selectedVoice = voices.find(voice => 
                        voice.name.includes(voiceName) || voice.lang.includes('ar')
                    );
                    if (selectedVoice) break;
                }
            } else if (currentLanguage === 'fr') {
                selectedVoice = voices.find(voice => 
                    voice.lang.startsWith('fr') && voice.lang.includes('FR')
                );
            } else {
                selectedVoice = voices.find(voice => 
                    voice.lang.startsWith('en') && voice.lang.includes('US')
                );
            }

            if (selectedVoice) {
                utterance.voice = selectedVoice;
            }

            synthesis.speak(utterance);
        }

        function switchLanguage(lang) {
            currentLanguage = lang;

            document.getElementById('chatTitle').textContent = TRANSLATIONS[lang].chatTitle;

            const learned = getLearnedKnowledge();
            const count = learned[lang].length;
            document.getElementById('statusText').textContent = count > 0 ? 
                `${TRANSLATIONS[lang].statusText.split('‚Ä¢')[0]}‚Ä¢ ${count} ŸÖÿπŸÑŸàŸÖÿßÿ™` : 
                TRANSLATIONS[lang].statusText;

            document.getElementById('userInput').placeholder = TRANSLATIONS[lang].inputPlaceholder;

            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });

            if (lang === 'ar') {
                document.documentElement.setAttribute('dir', 'rtl');
            } else {
                document.documentElement.setAttribute('dir', 'ltr');
            }

            if (recognition) {
                recognition.lang = TRANSLATIONS[lang].voiceLang;
            }
        }

        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>
